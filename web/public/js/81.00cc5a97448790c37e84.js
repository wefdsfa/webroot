webpackJsonp([81],{SWg4:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("3SZ7"),r=s.n(a),i=(s("wHeh"),s("C331")),n={props:{role:""},created:function(){var t=this,e=localStorage.getItem("lang");Object(i.f)(e)&&(this.lang=e),"college"===this.role?this.definedSearch.isCollege=!0:"school"===this.role?this.definedSearch.isCollege=!1:"collegeInstructor"===this.role?(this.definedSearch.queryType=1,this.url="/table-data/tutor/getStudentAndTutor"):"schoolInstructor"===this.role&&(this.definedSearch.queryType=0,this.url="/table-data/tutor/getStudentAndTutor"),Object(i.d)({url:"/api/relationship/getAdvancedSearchOptions",dataType:"json",type:"get",success:function(e){var s=e.data;if(e.state){t.newSearchData=s;var a=s.studentId.types,r=s.studentId.options,i=null;for(var n in r)(i={}).id=n,i.name=r[n],t.requirementOptions.push(i);for(var o in a)(i={}).id=o,i.name=a[o],t.relationOptions.push(i);for(var l in s)for(var c in s[l]){var d={};"key"===c&&(d.id=s[l][c],d.name=s[l].keyName,t.searchOptions.push(d))}s.studentId.dicts&&(t.valueOptions=s.studentId.dicts)}}}),Object(i.d)({url:"/api/relationship/getSelectOptions?isCollege="+this.definedSearch.isCollege,dataType:"json",type:"get",success:function(e){var s=e.data;e.state&&(s.colleges.forEach(function(e){t.collegeOptions.push(e)}),s.departments.forEach(function(e){t.departmentOptions.push(e)}),s.grades.forEach(function(e){t.gradeOptions.push(e)}),s.isDistributions.forEach(function(e){t.isSetOptions.push(e)}),s.instructors.forEach(function(e){t.instructorOptions.push(e)}))}});var s=void 0;"collegeInstructor"==this.role?s=1:"schoolInstructor"==this.role&&(s=0),0!=s&&1!=s||Object(i.d)({url:"/api/tutor/getSelectOptions?selectType="+s,dataType:"json",type:"get",success:function(e){var s=e.data;e.state&&(s.colleges.forEach(function(e){t.collegeTutorOptions.push(e)}),s.departments&&s.departments.forEach(function(e){t.departmentTutorOptions.push(e)}),s.grades.forEach(function(e){t.gradeTutorOptions.push(e)}),s.tutor.forEach(function(e){t.tutorOptions.push(e)}),s.educationLevel.forEach(function(e){t.educationLevelTutorOptions.push(e)}))}}),Object(i.d)({url:"/api/system/dicts?dictType=培养层次",dataType:"json",type:"get",async:!1,success:function(e){e.state&&(t.educationLevelOptions=e.data||[])}}),this._initColumns(),"school"==this.role||"college"==this.role?(Object(i.d)({url:"/api/relationship/getTempleteFileName/relStudent",dataType:"json",type:"get",success:function(e){e.state&&(t.importParams.templateName=e.data)}}),this.importParams.parentPageTitle=this.translate.tableName,this.importParams.importBtnType=[{name:this.translate.overriteImport,url:"/relationship/setStudentsInstructor",method:"post",isShowBtn:!0,success:function(e){!e.state||"colloge"!=t.role&&"school"!=t.role||(t.url="/table-data/relationship/relationStudents?timestamp="+(new Date).getTime())}}]):(this.importParams.templateName="导师带生关系模板.xlsx",this.importParams.downloadTemplateUrl="/tutor/excelDownload",this.importParams.downloadErrorTemplateUrl="/tutor/excelInput/error",this.importParams.parentPageTitle=this.translate.tableName,this.importParams.importBtnType=[{name:this.translate.overriteImport,url:"/tutor/inputExcelIfsuccess",method:"post",isShowBtn:!0,success:function(e){!e.state||"collegeInstructor"!=t.role&&"schoolInstructor"!=t.role||(t.url=t.url+"?timestamp="+(new Date).getTime())}}])},data:function(){return{showSetTutorModal:!1,collegeTutorOptions:[],departmentTutorOptions:[],gradeTutorOptions:[],tutorOptions:[],educationLevelTutorOptions:[],columns:[],url:"/table-data/relationship/relationStudents",importBtnType:[],importParams:{parentPageTitle:"",downloadTemplateUrl:"/relationship/downloadTemplete",downloadErrorTemplateUrl:"/relationship/downloadErrorExcel",templateName:"",importBtnType:null},showSetInstructorModal:!1,showBatchTransferModal:!1,showTutoeBatchTransferModal:!1,showAdvancedSearchModal:!1,isDisabled:{setInstructor:!0,batchTransfer:!0,advancedSearch:!1},NewRelationship:{},definedSearch:{searchDTOS:[],studentId:"",studentName:"",college:"",department:"",educationLevel:"",grade:"",isDistribution:"",instructorNo:"",isCollege:!0,queryType:0,isAdvancedSearch:!1},isAdvancedSearch:!1,method:"get",instructorOptions:[],gradeOptions:[],educationLevelOptions:[],departmentOptions:[],isSetOptions:[],collegeOptions:[],searchOptions:[],relationOptions:[],requirementOptions:[],valueOptions:[],defaultOptions:"-1",searchDefaultOptions:"studentId",reqDefaultOptions:"eq",relationDefaultOptions:"and",valueDefaultOptions:"",selectedList:[],setInstructorText:"",errorMessage:{setInstructor:"",inInstructor:"",outInstructor:""},instructorId:{single:"",transferIn:"",transferOut:""},studentUserIds:[],newSearchCondition:{searchOptionsText:"学号",requirementOptionsText:"等于",inputText:"",relationOptionsText:"并且"},newSearchArray:[],advancedSearch:{inputText:""},newSearchData:[],searchParameters:{key:"studentId",relation:"eq",value:"",tableName:"",type:"and"},searchDots:[],isExist:{outInstructor:!1,inInstructor:!1},isSelect:!1,isClearArray:!0,isClearSearchData:!1,tableCheckedList:[],isParentPage:!0,redColor:"",transferOutColor:"",transferInColor:"",showAddTypeModal:!1,showPluralismModal:!1,addType:"",curInstructorOpt:"",addTypeData:[{value:"soleDuty",label:"专职辅导员"},{value:"pluralism",label:"兼职辅导员"}],lang:"zh-cn"}},computed:{translate:function(){return Object(i.f)(this.lang).relationshipManage},checkTemplateUrl:function(){return"school"==this.role||"college"==this.role?"/relationship/uploadExcel/"+this.definedSearch.isCollege:"/tutor/check/"+this.definedSearch.isCollege},pageId:function(){return"relationship-page-"+this.role}},methods:{_tableChecked:function(t){this.tableCheckedList=t},_initColumns:function(){"school"==this.role||"college"==this.role?this.columns=[{id:"studentId",title:this.translate.studentId,className:"text-left",hidden:!1,width:120,search:{type:"input",data:{autoFocus:!0,placeholder:this.translate.studentIdPlaceholder}}},{id:"studentName",title:this.translate.name,className:"text-left",hidden:!1,width:120,search:{type:"input",data:{placeholder:this.translate.namePlaceholder}},formatter:function(t,e){return t.name}},{id:"college",title:this.translate.college,className:"text-left",hidden:!1,width:120,search:{type:"multiSelect",data:{options:this.collegeOptions,optionsLabel:"text",optionsValue:"id"}}},{id:"department",title:this.translate.department,className:"text-left",hidden:!1,width:120,search:{type:"multiSelect",data:{options:this.departmentOptions,optionsLabel:"text",optionsValue:"id"}}},{id:"educationLevel",title:"培养层次",className:"text-left",hidden:!1,width:120,search:{type:"multiSelect",data:{options:this.educationLevelOptions,optionsLabel:"label",optionsValue:"value"}}},{id:"grade",title:this.translate.grade,className:"text-center",hidden:!1,width:120,search:{type:"multiSelect",data:{options:this.gradeOptions,optionsLabel:"text",optionsValue:"id"}}},{id:"instructorNo",title:"专职辅导员",className:"text-left",hidden:!1,width:120,search:{type:"multiSelect",data:{options:this.instructorOptions,optionsLabel:"text",optionsValue:"id"}},formatter:function(t,e){return t.instructor}},{id:"partTimeInstructor",title:"兼职辅导员",className:"text-left",hidden:!1,width:120},{id:"classFullName",title:"班级",className:"text-center",hidden:!1,width:120,search:{type:"input",data:{placeholder:"班级"}}},{id:"changeLog",title:this.translate.optRecord,className:"text-left",hidden:!1,width:120}]:this.columns=[{id:"studentId",title:this.translate.studentId,className:"text-left",hidden:!1,width:120,search:{type:"input",data:{autoFocus:!0,placeholder:this.translate.studentIdPlaceholder}}},{id:"userName",title:this.translate.name,className:"text-left",hidden:!1,width:120,search:{type:"input",data:{placeholder:this.translate.namePlaceholder}},formatter:function(t,e){return t.studentName}},{id:"college",title:this.translate.college,className:"text-left",hidden:!1,width:120,search:{type:"multiSelect",data:{options:this.collegeTutorOptions,optionsLabel:"text",optionsValue:"id"}},formatter:function(t,e){return t.collegeName}},{id:"department",title:this.translate.department,className:"text-left",hidden:!1,width:120,search:{type:"multiSelect",data:{options:this.departmentTutorOptions,optionsLabel:"text",optionsValue:"id"}}},{id:"educationLever",title:"培养层次",className:"text-left",hidden:!1,width:120,search:{type:"multiSelect",data:{options:this.educationLevelTutorOptions,optionsLabel:"text",optionsValue:"id"}}},{id:"grade",title:this.translate.grade,className:"text-center",hidden:!1,width:120,search:{type:"multiSelect",data:{options:this.gradeTutorOptions,optionsLabel:"text",optionsValue:"id"}}},{id:"tutorId",title:"导师",className:"text-left",hidden:!1,width:120,search:{type:"multiSelect",data:{options:this.tutorOptions,optionsLabel:"text",optionsValue:"id"}},formatter:function(t,e){return t.tutorName}}]},showSearch:function(){this.showAdvancedSearchModal=!0,this.isClearSearchData&&(this.searchDots.splice(0,this.searchDots.length),this.newSearchArray.splice(0,this.newSearchArray.length)),this.searchParameters={key:"studentId",relation:"eq",value:"",type:"and"},this.advancedSearch.inputText="",this.searchParameters.tableName=this.newSearchData.studentId.tableName,this.newSearchCondition={searchOptionsText:"学号",requirementOptionsText:"等于",inputText:"",relationOptionsText:"并且"},this.isSelect=!1},addSearchOptions:function(){!1===this.isSelect&&(this.newSearchCondition.inputText=this.advancedSearch.inputText,this.searchParameters.value=this.advancedSearch.inputText),this.isClearArray&&this.searchDots.splice(0,this.searchDots.length),this.isClearArray=!1;var t=JSON.parse(r()(this.newSearchCondition));this.newSearchArray.push(t);var e=JSON.parse(r()(this.searchParameters));this.searchDots.push(e)},submitSet:function(t){if(t)return!1;!1===this.isSelect&&(this.searchParameters.value=this.advancedSearch.inputText),this.definedSearch.studentId=this.$refs.studentTable.tableSearchFields.studentId,this.definedSearch.studentName=this.$refs.studentTable.tableSearchFields.name,this.definedSearch.college=this.$refs.studentTable.tableSearchFields.college,this.definedSearch.educationLevel=this.$refs.studentTable.tableSearchFields.educationLevel,this.definedSearch.grade=this.$refs.studentTable.tableSearchFields.grade,this.definedSearch.department=this.$refs.studentTable.tableSearchFields.department,this.definedSearch.instructorNo=this.$refs.studentTable.tableSearchFields.instructorNo,this.searchDots.push(this.searchParameters),this.url="/table-data/relationship/advancedSearch",this.definedSearch.searchDTOS=JSON.parse(r()(this.searchDots)),this.method="post",this.showAdvancedSearchModal=!1,this.isClearSearchData=!0,this.definedSearch.isAdvancedSearch=!0},deleteSearch:function(t){if(this.newSearchArray.splice(t,1),this.searchDots.splice(t,1),0===this.searchDots.length){this.isClearArray=!0;var e=JSON.parse(r()(this.searchParameters));this.searchDots.push(e)}},searchOptionsSelected:function(t){if(t.target.selected){this.isDisabled.advancedSearch=!1,this.newSearchCondition.searchOptionsText=t.target.selected,this.searchParameters.key=t.val,this.searchDefaultOptions=t.value;var e=this.newSearchData[t.val],s=null;for(var a in this.requirementOptions.splice(0,this.requirementOptions.length),this.relationOptions.splice(0,this.relationOptions.length),this.searchParameters.tableName=e.tableName,e.options)(s={}).id=a,s.name=e.options[a],this.requirementOptions.push(s);for(var r in e.types)(s={}).id=r,s.name=e.types[r],this.relationOptions.push(s);this.isSelect=e.select,e.dicts&&(this.valueOptions=e.dicts,this.valueOptions&&(this.valueDefaultOptions=this.valueOptions[0].id,this.newSearchCondition.inputText=this.valueOptions[0].text,this.searchParameters.value=this.valueOptions[0].id))}else this.isDisabled.advancedSearch=!0},requirementSelected:function(t){t.target.selected?(this.isDisabled.advancedSearch=!1,this.newSearchCondition.requirementOptionsText=t.target.selected,this.searchParameters.relation=t.value,this.reqDefaultOptions=t.value):this.isDisabled.advancedSearch=!0},relationSelected:function(t){t.target.selected?(this.isDisabled.advancedSearch=!1,this.newSearchCondition.relationOptionsText=t.target.selected,this.searchParameters.type=t.value,this.relationDefaultOptions=t.value):this.isDisabled.advancedSearch=!0},valueSelected:function(t){t.target.selected?(this.isDisabled.advancedSearch=!1,this.newSearchCondition.inputText=t.target.selected,this.searchParameters.value=t.value,this.valueDefaultOptions=t.value):this.isDisabled.advancedSearch=!0},reset:function(){var t=this;if(this.studentUserIds.splice(0,this.studentUserIds.length),"college"===this.role||"school"===this.role?this.tableCheckedList.forEach(function(e,s){t.studentUserIds.push(e.studentUserId)}):this.tableCheckedList.forEach(function(e,s){t.studentUserIds.push(e.userId)}),0===this.tableCheckedList.length)this.$toast(this.translate.notSelectedText);else{var e=this.translate.selectedText+" "+this.tableCheckedList.length+" "+this.translate.namesStudent+",",s="",a="";if("soleDuty"===this.addType?(e+="确定重置他们专职辅导员吗?",s="/api/relationship/reSetInstructorNo",a="post"):(e+="确定重置他们兼职辅导员吗?",s="/api/part-time/instructor/reset",a="put"),confirm(e))if("school"==this.role||"college"==this.role)Object(i.d)({url:s,dataType:"json",data:{studentUserIds:this.studentUserIds},type:a,success:function(e){e.state?(t.url="/table-data/relationship/relationStudents?timestamp="+(new Date).getTime(),t.$toast(t.translate.submitSuccessTip),t.studentUserIds.splice(0,t.studentUserIds.length),t.tableCheckedList=[]):t.$toast(t.translate.submitFailedTip+":"+e.message)}});else{s="/api/tutor/refresh";var r="";this.studentUserIds.forEach(function(e,s){s<t.studentUserIds.length-1?r+=e+",":r+=e}),Object(i.d)({url:s+"?userIds="+r,dataType:"json",type:"post",success:function(e){e.state?(t.url=t.url+"?timestamp="+(new Date).getTime(),t.$toast(t.translate.submitSuccessTip),t.studentUserIds.splice(0,t.studentUserIds.length),t.tableCheckedList=[]):t.$toast(t.translate.submitFailedTip+":"+e.message)}})}}},selcetOptStyle:function(t){var e=this;"college"==this.role||"school"==this.role?(this.showAddTypeModal=!0,this.addType="",this.curInstructorOpt=t):"set"===t?(this.errorMessage.setInstructor="",this.NewRelationship.instructorId="",this.isDisabled.setInstructor=!0,this.studentUserIds.splice(0,this.studentUserIds.length),this.tableCheckedList.forEach(function(t,s){e.studentUserIds.push(t.userId)}),0===this.tableCheckedList.length?this.setInstructorText=this.translate.notSelectedText:this.setInstructorText=this.translate.selectedText+" "+this.tableCheckedList.length+" "+this.translate.namesStudent+",请在下方输入导师员工号",this.showSetTutorModal=!0):this.reset()},checkInstructor:function(){var t=this;if(!this.NewRelationship.instructorId)return this.redColor="red",this.errorMessage.setInstructor=this.translate.enterStudentId,!1;Object(i.d)({url:"/api/relationship/checkUserId/"+this.NewRelationship.instructorId,dataType:"json",type:"get",success:function(e){e.state?(t.redColor="black",t.errorMessage.setInstructor=e.data.name+" "+e.data.id,t.instructorId.single=e.data.userId,0===t.tableCheckedList.length?t.isDisabled.setInstructor=!0:t.isDisabled.setInstructor=!1):(t.redColor="red",t.errorMessage.setInstructor=e.message,t.isDisabled.setInstructor=!0)}})},checkTutor:function(){var t=this;if(!this.NewRelationship.instructorId)return this.redColor="red",this.errorMessage.setInstructor=this.translate.enterStudentId,!1;Object(i.d)({url:"/api/tutor/check?userNo="+this.NewRelationship.instructorId,dataType:"json",type:"get",success:function(e){e.state?(t.redColor="black",t.errorMessage.setInstructor=e.data.tutorName,t.instructorId.single=e.data.userNo,0===t.tableCheckedList.length?t.isDisabled.setInstructor=!0:t.isDisabled.setInstructor=!1):(t.redColor="red",t.errorMessage.setInstructor=e.message,t.isDisabled.setInstructor=!0)}})},_selectAddType:function(t){this.addType=t.value},_sumbitTypeModal:function(){var t=this;"set"===this.curInstructorOpt?(this.errorMessage.setInstructor="",this.NewRelationship.instructorId="",this.isDisabled.setInstructor=!0,this.studentUserIds.splice(0,this.studentUserIds.length),this.tableCheckedList.forEach(function(e,s){t.studentUserIds.push(e.studentUserId)}),0===this.tableCheckedList.length?this.setInstructorText=this.translate.notSelectedText:this.setInstructorText=this.translate.selectedText+" "+this.tableCheckedList.length+" "+this.translate.namesStudent+","+this.translate.setSelectedText,"soleDuty"===this.addType?this.showSetInstructorModal=!0:this.showPluralismModal=!0):this.reset(),this.showAddTypeModal=!1},setPluralismInstructor:function(t){var e=this;if(t)return!1;Object(i.d)({url:"/api/part-time/instructor",dataType:"json",type:"put",data:{studentUserIds:this.studentUserIds,teacherUserId:this.instructorId.single},success:function(t){t.state?(e.url="/table-data/relationship/relationStudents?timestamp="+(new Date).getTime(),e.showPluralismModal=!1,e.studentUserIds.splice(0,e.studentUserIds.length),e.tableCheckedList=[],e.$toast(e.translate.submitSuccessTip)):e.$toast(e.translate.submitFailedTip+":"+t.message)}})},setSingInstructor:function(t){var e=this;if(t)return!1;if("school"==this.role||"college"==this.role)Object(i.d)({url:"/api/relationship/setInstructor",dataType:"json",data:{studentUserIds:this.studentUserIds,teacherUserId:this.instructorId.single},type:"post",success:function(t){t.state?(e.url="/table-data/relationship/relationStudents?timestamp="+(new Date).getTime(),e.showSetTutorModal=!1,e.studentUserIds.splice(0,e.studentUserIds.length),e.tableCheckedList=[],e.$toast(e.translate.submitSuccessTip),e.showSetInstructorModal=!1):e.$toast(e.translate.submitFailedTip+":"+t.message)}});else{var s="";this.studentUserIds.forEach(function(t,a){a<e.studentUserIds.length-1?s+=t+",":s+=t}),Object(i.d)({url:"/api/tutor/tutorSetting?userIdList="+s+"&tutorNo="+this.instructorId.single,dataType:"json",type:"post",success:function(t){t.state?(e.url=e.url+"?timestamp="+(new Date).getTime(),e.showSetTutorModal=!1,e.studentUserIds.splice(0,e.studentUserIds.length),e.tableCheckedList=[],e.$toast(e.translate.submitSuccessTip)):e.$toast(e.translate.submitFailedTip+":"+t.message)}})}},batchTransfer:function(){this.errorMessage.outInstructor="",this.NewRelationship.outInstructor="",this.errorMessage.inInstructor="",this.NewRelationship.inInstructor="",this.isDisabled.batchTransfer=!0,"school"==this.role||"college"==this.role?this.showBatchTransferModal=!0:this.showTutoeBatchTransferModal=!0},batchSet:function(){this.isParentPage=!1},backParentPage:function(){this.isParentPage=!0},checkOutInstructor:function(){var t=this;if(!this.NewRelationship.outInstructor)return this.transferOutColor="red",this.errorMessage.outInstructor=this.translate.enterStudentId,!1;Object(i.d)({url:"/api/relationship/checkUserIdAndCount/"+this.NewRelationship.outInstructor,dataType:"json",type:"get",success:function(e){e.state?(t.transferOutColor="black",t.errorMessage.outInstructor=e.data.name+" "+e.data.id+" "+t.translate.transferResultText+e.data.count+t.translate.namesStudent,t.instructorId.transferOut=e.data.userId,t.isExist.outInstructor=!0,t.isExist.inInstructor&&(t.isDisabled.batchTransfer=!1)):(t.transferOutColor="red",t.isExist.outInstructor=!1,t.errorMessage.outInstructor=e.message,t.isDisabled.batchTransfer=!0)}})},checkInInstructor:function(){var t=this;if(!this.NewRelationship.inInstructor)return this.transferInColor="red",this.errorMessage.inInstructor=this.translate.enterStudentId,!1;Object(i.d)({url:"/api/relationship/checkUserIdAndCount/"+this.NewRelationship.inInstructor,dataType:"json",type:"get",success:function(e){e.state?(t.transferInColor="black",t.errorMessage.inInstructor=e.data.name+" "+e.data.id+" "+t.translate.transferResultText+e.data.count+t.translate.namesStudent,t.instructorId.transferIn=e.data.userId,t.isExist.inInstructor=!0,t.isExist.outInstructor&&(t.isDisabled.batchTransfer=!1)):(t.transferInColor="red",t.isExist.inInstructor=!1,t.errorMessage.inInstructor=e.message,t.isDisabled.batchTransfer=!0)}})},checkOutTutor:function(){var t=this;if(!this.NewRelationship.outInstructor)return this.transferOutColor="red",this.errorMessage.outInstructor=this.translate.enterStudentId,!1;Object(i.d)({url:"/api/tutor/check?userNo="+this.NewRelationship.outInstructor,dataType:"json",type:"get",success:function(e){e.state?(t.transferOutColor="black",t.errorMessage.outInstructor=e.data.tutorName,t.instructorId.transferOut=e.data.userNo,t.isExist.outInstructor=!0,t.isExist.inInstructor&&(t.isDisabled.batchTransfer=!1)):(t.transferOutColor="red",t.isExist.outInstructor=!1,t.errorMessage.outInstructor=e.message,t.isDisabled.batchTransfer=!0)}})},checkInTutor:function(){var t=this;if(!this.NewRelationship.inInstructor)return this.transferInColor="red",this.errorMessage.inInstructor=this.translate.enterStudentId,!1;Object(i.d)({url:"/api/tutor/check?userNo="+this.NewRelationship.inInstructor,dataType:"json",type:"get",success:function(e){e.state?(t.transferInColor="black",t.errorMessage.inInstructor=e.data.tutorName,t.instructorId.transferIn=e.data.userNo,t.isExist.inInstructor=!0,t.isExist.outInstructor&&(t.isDisabled.batchTransfer=!1)):(t.transferInColor="red",t.isExist.inInstructor=!1,t.errorMessage.inInstructor=e.message,t.isDisabled.batchTransfer=!0)}})},submitTransfer:function(t){var e=this;if(t)return!1;"college"==this.role||"school"==this.role?Object(i.d)({url:"/api/relationship/changeInstructorToAnotherOne",dataType:"json",data:{oldInstructorNo:this.instructorId.transferOut,newInstructorNo:this.instructorId.transferIn},type:"post",success:function(t){t.state?(e.url="/table-data/relationship/relationStudents?timestamp="+(new Date).getTime(),e.showBatchTransferModal=!1,e.$toast(e.translate.submitSuccessTip)):e.$toast(e.translate.submitFailedTip+":"+t.message)}}):Object(i.d)({url:"/api/tutor/tutorBySetting?tutorNo="+this.instructorId.transferOut+"&tutorNoCopy="+this.instructorId.transferIn,dataType:"json",type:"post",success:function(t){t.state?(e.url=e.url+"?timestamp="+(new Date).getTime(),e.showTutoeBatchTransferModal=!1,e.$toast(e.translate.submitSuccessTip)):e.$toast(e.translate.submitFailedTip+":"+t.message)}})},exportTable:function(){var t=this;if("school"==this.role||"college"==this.role){this.$waiting.show(),this.definedSearch.studentId=this.$refs.studentTable.tableSearchFields.studentId,this.definedSearch.studentName=this.$refs.studentTable.tableSearchFields.name,this.definedSearch.college=this.$refs.studentTable.tableSearchFields.college,this.definedSearch.educationLevel=this.$refs.studentTable.tableSearchFields.educationLevel,this.definedSearch.grade=this.$refs.studentTable.tableSearchFields.grade,this.definedSearch.department=this.$refs.studentTable.tableSearchFields.department,this.definedSearch.instructorNo=this.$refs.studentTable.tableSearchFields.instructorNo;var e={};e.studentId=this.definedSearch.studentId,e.studentName=this.definedSearch.studentName,e.isCollege=this.definedSearch.isCollege,e.isAdvancedSearch=this.definedSearch.isAdvancedSearch,e.searchDTOS=this.definedSearch.searchDTOS,Object(i.d)({url:"/api/relationship/downloadRelationshipStudents?college="+this.definedSearch.college+"&department="+this.definedSearch.department+"&educationLevel="+this.definedSearch.educationLevel+"&grade="+this.definedSearch.grade+"&instructorNo="+this.definedSearch.instructorNo,dataType:"json",data:e,type:"post",success:function(e){e.state?window.location.href="/downloads/relationship/downloadExportFile?fileName="+e.data:t.$toast(e.message)}}).always(function(){t.$waiting.close()})}else"collegeInstructor"==this.role?window.location.href="/downloads/tutor/downLoadStudentBycollege?fileName=全院研究生信息&pageIndex=1&pageSize=50000":"schoolInstructor"==this.role&&(window.location.href="/downloads/tutor/downLoadStudent?fileName=全校研究生信息&pageIndex=1&pageSize=50000")},isSetOptionsSelected:function(t){"-1"===t.val?this.definedSearch.isDistribution="":this.definedSearch.isDistribution=t.val}}},o={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.isParentPage?s("div",{staticClass:"relationship-page container-fluid",attrs:{id:t.pageId}},[s("div",{staticClass:"row text-center"},[s("v-table",{ref:"studentTable",attrs:{title:t.tableCheckedList.length>0?"":t.translate.tableName,method:t.method,url:t.url,pagesize:"10",idField:"id",columns:t.columns,multiple:!0,order:!0,searchParams:t.definedSearch,search:!0},on:{afterChecked:t._tableChecked}},[s("div",{attrs:{slot:"btn-group",role:"group"},slot:"btn-group"},[s("div",{staticClass:"btn-group pull-left"},[t.tableCheckedList.length>0?s("div",{staticClass:"batch-options"},[s("span",{staticClass:"pull-left"},[t._v("已选择"+t._s(t.tableCheckedList.length)+"项，其中可操作的有"+t._s(t.tableCheckedList.length)+"项")]),t._v(" "),s("div",{staticClass:"pull-left"},[s("button",{staticClass:"btn btn-bgColor-style clearBtnBorder resetBtn",staticStyle:{"margin-left":"10px"},attrs:{type:"button"},on:{click:function(e){return t.selcetOptStyle("reset")}}},[t._v(t._s(t.translate.reset)+t._s("school"==t.role||"college"==t.role?t.translate.instructor:"导师")),s("span",[t._v(t._s(t.translate.resetHoverText))])]),t._v(" "),s("button",{staticClass:"btn btn-bgColor-style clearBtnBorder",attrs:{type:"button"},on:{click:function(e){return t.selcetOptStyle("set")}}},[t._v(t._s(t.translate.set)+t._s("school"==t.role||"college"==t.role?t.translate.instructor:"导师"))])])]):t._e()]),t._v(" "),s("div",{staticClass:"btn-group pull-right"},["school"==t.role||"college"==t.role?s("button",{staticClass:"btn btn-bgColor-style clearBtnBorder",attrs:{type:"button"},on:{click:function(e){return t.showSearch()}}},[t._v(t._s(t.translate.advancedSearch))]):t._e(),t._v(" "),s("button",{staticClass:"btn btn-bgColor-style clearBtnBorder",attrs:{type:"button"},on:{click:function(e){return t.batchTransfer()}}},[t._v(t._s(t.translate.batch)+t._s(t.translate.transfer))]),t._v(" "),s("button",{staticClass:"btn btn-bgColor-style clearBtnBorder",attrs:{type:"button"},on:{click:function(e){return t.batchSet()}}},[t._v(t._s(t.translate.batch)+t._s(t.translate.set))]),t._v(" "),s("button",{staticClass:"btn btn-bgColor-style clearBtnBorder",attrs:{type:"button"},on:{click:function(e){return t.exportTable()}}},[t._v(t._s(t.translate.export))])])]),t._v(" "),s("div",{attrs:{slot:"table-search"},slot:"table-search"},[s("div",{staticClass:"input-group search-group pull-left col-md-3 col-md-offset-1"},[s("span",{staticClass:"input-group-addon search-name",attrs:{id:"basic-relationship-isSet"}},[t._v(t._s(t.translate.isSet))]),t._v(" "),s("v-select",{staticClass:"btn-block search-select",attrs:{value:t.defaultOptions,options:t.isSetOptions,"options-value":"id","options-label":"text",search:""},on:{afterSelected:t.isSetOptionsSelected}})],1)])])],1),t._v(" "),s("v-modal",{attrs:{show:t.showAdvancedSearchModal,effect:"fade",width:"580"}},[s("div",{staticClass:"modal-header",attrs:{slot:"modal-header"},slot:"modal-header"},[s("h5",{staticClass:"modal-title"},[t._v("\n        "+t._s(t.translate.advancedSearch)+"\n    ")])]),t._v(" "),s("div",{staticClass:"modal-body",attrs:{slot:"modal-body"},slot:"modal-body"},[t._l(t.newSearchArray,function(e,a){return s("div",{key:a,staticClass:"form-group"},[s("label",{staticClass:"add-search-text"},[t._v(t._s(e.searchOptionsText))]),t._v(" "),s("label",{staticClass:"add-search-text"},[t._v(t._s(e.requirementOptionsText))]),t._v(" "),s("label",{staticClass:"inputText"},[t._v(t._s(e.inputText))]),t._v(" "),s("label",{staticClass:"add-search-text"},[t._v(t._s(e.relationOptionsText))]),t._v(" "),s("button",{staticClass:"btn deleteBtn clearBtnBorder",attrs:{type:"button"},on:{click:function(e){return t.deleteSearch(a)}}},[t._v(t._s(t.translate.delete))])])}),t._v(" "),t.showAdvancedSearchModal?s("div",{staticClass:"form-group advancedSearch-group"},[s("v-select",{attrs:{options:t.searchOptions,value:t.searchDefaultOptions,optionsLabel:"name",optionsValue:"id",search:!0},on:{afterSelected:t.searchOptionsSelected}}),t._v(" "),s("v-select",{attrs:{options:t.requirementOptions,value:t.reqDefaultOptions,optionsLabel:"name",optionsValue:"id",search:!0},on:{afterSelected:t.requirementSelected}}),t._v(" "),t.isSelect?s("v-select",{attrs:{options:t.valueOptions,value:t.valueDefaultOptions,optionsLabel:"text",optionsValue:"id",search:!0},on:{afterSelected:t.valueSelected}}):s("input",{directives:[{name:"model",rawName:"v-model",value:t.advancedSearch.inputText,expression:"advancedSearch.inputText"}],staticClass:"value-input",attrs:{type:"text"},domProps:{value:t.advancedSearch.inputText},on:{input:function(e){e.target.composing||t.$set(t.advancedSearch,"inputText",e.target.value)}}}),t._v(" "),s("v-select",{attrs:{options:t.relationOptions,value:t.relationDefaultOptions,optionsLabel:"name",optionsValue:"id",search:!0},on:{afterSelected:t.relationSelected}}),t._v(" "),s("button",{staticClass:"btn addBtn clearBtnBorder",attrs:{type:"button"},on:{click:function(e){return t.addSearchOptions()}}},[t._v(t._s(t.translate.addNew))])],1):t._e()],2),t._v(" "),s("div",{staticClass:"modal-footer",attrs:{slot:"modal-footer"},slot:"modal-footer"},[s("button",{staticClass:"btn cancel-btn clearBtnBorder",attrs:{type:"button"},on:{click:function(e){t.showAdvancedSearchModal=!1}}},[t._v(t._s(t.translate.cancel))]),t._v(" "),s("button",{staticClass:"btn submit-btn clearBtnBorder",class:{disabled:t.isDisabled.advancedSearch},attrs:{type:"button"},on:{click:function(e){return t.submitSet(t.isDisabled.advancedSearch)}}},[t._v(t._s(t.translate.search))])])]),t._v(" "),s("v-modal",{attrs:{show:t.showAddTypeModal,effect:"fade",width:"400"}},[s("div",{staticClass:"modal-header",attrs:{slot:"modal-header"},slot:"modal-header"},[s("h5",{staticClass:"modal-title"},[t._v("选择新增辅导员类型")])]),t._v(" "),s("div",{staticClass:"modal-body",attrs:{slot:"modal-body"},slot:"modal-body"},[s("div",{staticClass:"info-item"},[s("div",{staticClass:"info-options"},t._l(t.addTypeData,function(e,a){return s("span",{key:a,on:{click:function(s){return t._selectAddType(e)}}},[s("i",{staticClass:"maticon",class:t.addType===e.value?"active":"",domProps:{innerHTML:t._s(t.icons(t.addType===e.value?"radio_button_checked":"radio_button_unchecked"))}}),t._v("\n            "+t._s(e.label)+"\n          ")])}),0)])]),t._v(" "),s("div",{staticClass:"modal-footer",attrs:{slot:"modal-footer"},slot:"modal-footer"},[s("button",{staticClass:"btn cancel-btn clearBtnBorder",attrs:{type:"button"},on:{click:function(e){t.showAddTypeModal=!1}}},[t._v("取消")]),t._v(" "),s("button",{staticClass:"btn submit-btn clearBtnBorder",attrs:{type:"button"},on:{click:t._sumbitTypeModal}},[t._v("确定")])])]),t._v(" "),s("v-modal",{attrs:{show:t.showSetInstructorModal,effect:"fade",width:"500"}},[s("div",{staticClass:"modal-header",attrs:{slot:"modal-header"},slot:"modal-header"},[s("h5",{staticClass:"modal-title"},[t._v("\n        "+t._s(t.translate.set)+"专职"+t._s(t.translate.instructor)+"\n    ")])]),t._v(" "),s("div",{staticClass:"modal-body",attrs:{slot:"modal-body"},slot:"modal-body"},[s("div",{staticClass:"instructor-text text-center"},[t._v(t._s(t.setInstructorText))]),t._v(" "),s("div",{staticClass:"form-group"},[s("label",[t._v(t._s(t.translate.teacherAndStudentId))]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.NewRelationship.instructorId,expression:"NewRelationship.instructorId"}],staticClass:"form-control search-input modal-input",attrs:{type:"text"},domProps:{value:t.NewRelationship.instructorId},on:{input:function(e){e.target.composing||t.$set(t.NewRelationship,"instructorId",e.target.value)}}}),t._v(" "),s("button",{staticClass:"btn check-btn clearBtnBorder",attrs:{type:"button"},on:{click:t.checkInstructor}},[t._v(t._s(t.translate.check))])]),t._v(" "),s("div",{staticClass:"check-result",style:{color:t.redColor}},[t._v(t._s(t.errorMessage.setInstructor))])]),t._v(" "),s("div",{staticClass:"modal-footer",attrs:{slot:"modal-footer"},slot:"modal-footer"},[s("button",{staticClass:"btn cancel-btn clearBtnBorder",attrs:{type:"button"},on:{click:function(e){t.showSetInstructorModal=!1}}},[t._v(t._s(t.translate.cancel))]),t._v(" "),s("button",{staticClass:"btn submit-btn clearBtnBorder",class:{disabled:t.isDisabled.setInstructor},attrs:{type:"button"},on:{click:function(e){return t.setSingInstructor(t.isDisabled.setInstructor)}}},[t._v(t._s(t.translate.submit))])])]),t._v(" "),s("v-modal",{attrs:{show:t.showSetTutorModal,effect:"fade",width:"500"}},[s("div",{staticClass:"modal-header",attrs:{slot:"modal-header"},slot:"modal-header"},[s("h5",{staticClass:"modal-title"},[t._v("\n        "+t._s(t.translate.set)+"导师\n    ")])]),t._v(" "),s("div",{staticClass:"modal-body",attrs:{slot:"modal-body"},slot:"modal-body"},[s("div",{staticClass:"instructor-text text-center"},[t._v(t._s(t.setInstructorText))]),t._v(" "),s("div",{staticClass:"form-group"},[s("label",[t._v("员工号")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.NewRelationship.instructorId,expression:"NewRelationship.instructorId"}],staticClass:"form-control search-input modal-input",attrs:{type:"text"},domProps:{value:t.NewRelationship.instructorId},on:{input:function(e){e.target.composing||t.$set(t.NewRelationship,"instructorId",e.target.value)}}}),t._v(" "),s("button",{staticClass:"btn check-btn clearBtnBorder",attrs:{type:"button"},on:{click:t.checkTutor}},[t._v(t._s(t.translate.check))])]),t._v(" "),s("div",{staticClass:"check-result",style:{color:t.redColor}},[t._v(t._s(t.errorMessage.setInstructor))])]),t._v(" "),s("div",{staticClass:"modal-footer",attrs:{slot:"modal-footer"},slot:"modal-footer"},[s("button",{staticClass:"btn cancel-btn clearBtnBorder",attrs:{type:"button"},on:{click:function(e){t.showSetTutorModal=!1}}},[t._v(t._s(t.translate.cancel))]),t._v(" "),s("button",{staticClass:"btn submit-btn clearBtnBorder",class:{disabled:t.isDisabled.setInstructor},attrs:{type:"button"},on:{click:function(e){return t.setSingInstructor(t.isDisabled.setInstructor)}}},[t._v(t._s(t.translate.submit))])])]),t._v(" "),s("v-modal",{attrs:{show:t.showPluralismModal,effect:"fade",width:"420"}},[s("div",{staticClass:"modal-header",attrs:{slot:"modal-header"},slot:"modal-header"},[s("h5",{staticClass:"modal-title"},[t._v("\n        "+t._s(t.translate.set)+"兼职"+t._s(t.translate.instructor)+"\n    ")])]),t._v(" "),s("div",{staticClass:"modal-body",attrs:{slot:"modal-body"},slot:"modal-body"},[s("div",{staticClass:"instructor-text text-center"},[t._v(t._s(t.setInstructorText))]),t._v(" "),s("div",{staticClass:"form-group"},[s("label",[t._v(t._s(t.translate.teacherAndStudentId))]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.NewRelationship.instructorId,expression:"NewRelationship.instructorId"}],staticClass:"form-control search-input modal-input",attrs:{type:"text"},domProps:{value:t.NewRelationship.instructorId},on:{input:function(e){e.target.composing||t.$set(t.NewRelationship,"instructorId",e.target.value)}}}),t._v(" "),s("button",{staticClass:"btn check-btn clearBtnBorder",attrs:{type:"button"},on:{click:t.checkInstructor}},[t._v(t._s(t.translate.check))])]),t._v(" "),s("div",{staticClass:"check-result",style:{color:t.redColor}},[t._v(t._s(t.errorMessage.setInstructor))])]),t._v(" "),s("div",{staticClass:"modal-footer",attrs:{slot:"modal-footer"},slot:"modal-footer"},[s("button",{staticClass:"btn cancel-btn clearBtnBorder",attrs:{type:"button"},on:{click:function(e){t.showPluralismModal=!1}}},[t._v(t._s(t.translate.cancel))]),t._v(" "),s("button",{staticClass:"btn submit-btn clearBtnBorder",class:{disabled:t.isDisabled.setInstructor},attrs:{type:"button"},on:{click:function(e){return t.setPluralismInstructor(t.isDisabled.setInstructor)}}},[t._v(t._s(t.translate.submit))])])]),t._v(" "),s("v-modal",{attrs:{show:t.showBatchTransferModal,effect:"fade",width:"450"}},[s("div",{staticClass:"modal-header",attrs:{slot:"modal-header"},slot:"modal-header"},[s("h5",{staticClass:"modal-title"},[t._v("\n        "+t._s(t.translate.instructorBatchSet)+"\n    ")])]),t._v(" "),s("div",{staticClass:"modal-body",attrs:{slot:"modal-body"},slot:"modal-body"},[s("div",{staticClass:"transferOut"},[s("div",{staticClass:"modal-text text-center"},[t._v(t._s(t.translate.transferOutText))]),t._v(" "),s("div",{staticClass:"form-group"},[s("label",[t._v(t._s(t.translate.teacherAndStudentId))]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.NewRelationship.outInstructor,expression:"NewRelationship.outInstructor"}],staticClass:"form-control modal-input search-input",attrs:{type:"text"},domProps:{value:t.NewRelationship.outInstructor},on:{input:function(e){e.target.composing||t.$set(t.NewRelationship,"outInstructor",e.target.value)}}}),t._v(" "),s("button",{staticClass:"btn check-btn clearBtnBorder",attrs:{type:"button"},on:{click:t.checkOutInstructor}},[t._v(t._s(t.translate.check))])]),t._v(" "),s("div",{staticClass:"check-result",style:{color:t.transferOutColor}},[t._v(t._s(t.errorMessage.outInstructor))])]),t._v(" "),s("div",{staticClass:"transferIn"},[s("div",{staticClass:"modal-text text-center"},[t._v(t._s(t.translate.transferInText))]),t._v(" "),s("div",{staticClass:"form-group"},[s("label",[t._v(t._s(t.translate.teacherAndStudentId))]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.NewRelationship.inInstructor,expression:"NewRelationship.inInstructor"}],staticClass:"form-control modal-input search-input",attrs:{type:"text"},domProps:{value:t.NewRelationship.inInstructor},on:{input:function(e){e.target.composing||t.$set(t.NewRelationship,"inInstructor",e.target.value)}}}),t._v(" "),s("button",{staticClass:"btn check-btn clearBtnBorder",attrs:{type:"button"},on:{click:t.checkInInstructor}},[t._v(t._s(t.translate.check))])]),t._v(" "),s("div",{staticClass:"check-result",style:{color:t.transferInColor}},[t._v(t._s(t.errorMessage.inInstructor))])]),t._v(" "),s("div",{staticClass:"transfer-text text-center"},[t._v(t._s(t.translate.transferText))])]),t._v(" "),s("div",{staticClass:"modal-footer",attrs:{slot:"modal-footer"},slot:"modal-footer"},[s("button",{staticClass:"btn cancel-btn clearBtnBorder",attrs:{type:"button"},on:{click:function(e){t.showBatchTransferModal=!1}}},[t._v(t._s(t.translate.cancel))]),t._v(" "),s("button",{staticClass:"btn submit-btn clearBtnBorder",class:{disabled:t.isDisabled.batchTransfer},attrs:{type:"button"},on:{click:function(e){return t.submitTransfer(t.isDisabled.batchTransfer)}}},[t._v(t._s(t.translate.submit))])])]),t._v(" "),s("v-modal",{attrs:{show:t.showTutoeBatchTransferModal,effect:"fade",width:"450"}},[s("div",{staticClass:"modal-header",attrs:{slot:"modal-header"},slot:"modal-header"},[s("h5",{staticClass:"modal-title"},[t._v("\n        导师带生关系批量设置\n    ")])]),t._v(" "),s("div",{staticClass:"modal-body",attrs:{slot:"modal-body"},slot:"modal-body"},[s("div",{staticClass:"transferOut"},[s("div",{staticClass:"modal-text text-center"},[t._v("转出的导师员工号")]),t._v(" "),s("div",{staticClass:"form-group"},[s("label",[t._v("员工号")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.NewRelationship.outInstructor,expression:"NewRelationship.outInstructor"}],staticClass:"form-control modal-input search-input",attrs:{type:"text"},domProps:{value:t.NewRelationship.outInstructor},on:{input:function(e){e.target.composing||t.$set(t.NewRelationship,"outInstructor",e.target.value)}}}),t._v(" "),s("button",{staticClass:"btn check-btn clearBtnBorder",attrs:{type:"button"},on:{click:t.checkOutTutor}},[t._v(t._s(t.translate.check))])]),t._v(" "),s("div",{staticClass:"check-result",style:{color:t.transferOutColor}},[t._v(t._s(t.errorMessage.outInstructor))])]),t._v(" "),s("div",{staticClass:"transferIn"},[s("div",{staticClass:"modal-text text-center"},[t._v(t._s(t.translate.transferInText))]),t._v(" "),s("div",{staticClass:"form-group"},[s("label",[t._v("员工号")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.NewRelationship.inInstructor,expression:"NewRelationship.inInstructor"}],staticClass:"form-control modal-input search-input",attrs:{type:"text"},domProps:{value:t.NewRelationship.inInstructor},on:{input:function(e){e.target.composing||t.$set(t.NewRelationship,"inInstructor",e.target.value)}}}),t._v(" "),s("button",{staticClass:"btn check-btn clearBtnBorder",attrs:{type:"button"},on:{click:t.checkInTutor}},[t._v(t._s(t.translate.check))])]),t._v(" "),s("div",{staticClass:"check-result",style:{color:t.transferInColor}},[t._v(t._s(t.errorMessage.inInstructor))])]),t._v(" "),s("div",{staticClass:"transfer-text text-center"},[t._v("设置成功后转出导师分管的所有学生将全部转至转入导师下")])]),t._v(" "),s("div",{staticClass:"modal-footer",attrs:{slot:"modal-footer"},slot:"modal-footer"},[s("button",{staticClass:"btn cancel-btn clearBtnBorder",attrs:{type:"button"},on:{click:function(e){t.showTutoeBatchTransferModal=!1}}},[t._v(t._s(t.translate.cancel))]),t._v(" "),s("button",{staticClass:"btn submit-btn clearBtnBorder",class:{disabled:t.isDisabled.batchTransfer},attrs:{type:"button"},on:{click:function(e){return t.submitTransfer(t.isDisabled.batchTransfer)}}},[t._v(t._s(t.translate.submit))])])])],1):s("v-import",t._b({attrs:{checkTemplateUrl:t.checkTemplateUrl},on:{backParentPage:t.backParentPage}},"v-import",t.importParams,!1))},staticRenderFns:[]};var l=s("Mz/3")(n,o,!1,function(t){s("tslr")},null,null);e.default=l.exports},tslr:function(t,e){}});