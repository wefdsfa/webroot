webpackJsonp([163],{WwN5:function(t,e){},o0lZ:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=i("mvHQ"),a=i.n(s),o=(i("7+uW"),i("C331")),n=i("y0ro"),r=(n.a,{mixins:[n.a],data:function(){return{submitCtrl:!1,dicNameErrorTip:!1,columns:[],url:"/table-data/system/dictTypes/pages",showAddModal:!1,flow:{},newFlow:{id:"",dicts:[{id:"",label:"",value:"",sort:0}],name:"",rank:"customDefined"},newDictionaryType:{},modalType:"",lang:"zh-cn",dicName:"",showOptionInput:!1,optionsArr:[],optionInputTemp:"",inputContent:"",errorMsg:""}},created:function(){var t=localStorage.getItem("lang"),e=this;Object(o.g)(t)&&(this.lang=t),this.columns=[{id:"name",title:this.translate.dictionaryTypeName,className:"text-left",hidden:!1,width:150,search:{type:"input",data:{placeholder:this.translate.dictionaryTypeSearchPlaceholder,autoFocus:!0}}},{id:"dictionaryOption",title:this.translate.dictionaryOption,className:"text-left text-overflow",hidden:!1,width:550,formatter:function(t){if(!t.dicts)return"";var e="";return t.dicts.forEach(function(t){e+=t.label+" "}),e}},{id:"opt",className:"text-center",title:this.translate.operation,width:120,hidden:!1,formatter:function(){return[{tag:"a",text:e.translate.edit,className:"opt-btn",callback:function(t,i){e.flow=JSON.parse(a()(t)),e.dicName=e.flow.name;for(var s=0;s<e.flow.dicts.length;s++)e.optionsArr.push({id:e.flow.id,label:e.flow.dicts[s].label,value:e.flow.dicts[s].value,sort:e.flow.dicts[s].sort,edit:!1});e.newFlow.id=e.flow.id,e.newFlow.name=e.flow.name,e.dicName=e.flow.name,e.newFlow.dicts=e.flow.dicts,e.modalType=e.translate.edit,e.showAddModal=!0,e.dicNameErrorTip=!1,e.submitCtrl=!1}},{tag:"a",text:e.translate.remove,className:"opt-btn",callback:function(t,i){"systemDefined"!==t.rank?Object(o.e)({url:"/api/system/dictTypes/"+t.id,dataType:"json",type:"DELETE",success:function(t){confirm(e.translate.removeConfirmTip)&&(t.state?e.url+="?time="+(new Date).getTime():e.$toast(e.translate.removeFailedTip))}}):e.$toast("默认字段无法删除！")}}]}}]},computed:{translate:function(){return Object(o.g)(this.lang).dictionaryManage}},methods:{editable:function(t,e){"systemDefined"!==this.flow.rank?(this.optionsArr[e].edit=!0,this.optionInputTemp=t.label):this.$toast("默认选项无法修改!")},dicNameDisabled:function(){"systemDefined"!==this.flow.rank||this.$toast("默认名称无法修改!")},submit:function(){var t=this;if(!this.dicName)return this.dicNameErrorTip=!0,void(this.errorMsg="字典名称不能为空");if(this.submitCtrl)this.errorMsg="请输入正确的字典名称",this.dicNameErrorTip=!0;else{this.errorMsg="",this.dicNameErrorTip=!1,this.newFlow.dicts=[],this.optionsArr.forEach(function(e){delete e.edit,t.newFlow.dicts.push(e)});var e=this;this.modalType===this.translate.edit?Object(o.e)({url:"/api/system/dictTypeWithDicts/"+this.newFlow.id,dataType:"json",data:{dicts:this.newFlow.dicts,name:this.dicName},type:"PUT",success:function(t){t.state?(e.url+="?time="+(new Date).getTime(),e.showAddModal=!1,e.showOptionInput=!1):this.$toast(t.message)}}):Object(o.e)({url:"/api/system/dictTypeWithDicts",data:{dicts:this.newFlow.dicts,name:this.dicName},type:"post",success:function(t){t.state?(e.url+="?time="+(new Date).getTime(),e.showAddModal=!1,e.showOptionInput=!1):this.$toast(t.message)}}),this.optionsArr=[],this.flow="",this.dicName="",this.showAddModal=!1,this.showOptionInput=!1}},cancel:function(){this.showAddModal=!1,this.optionsArr=[],this.flow="",this.dicName=""},addOption:function(){"systemDefined"!==this.flow.rank?this.showOptionInput=!this.showOptionInput:(this.inputContent="",this.$toast("默认字段无法添加选项!"))},optionInput:function(){var t=this;this.optionsArr.find(function(e){return e.label===t.inputContent})?(this.inputContent="",this.$toast("该选项已存在!")):""===this.inputContent||/^[ ]+$/.test(this.inputContent)?this.$toast("新增选项名不能为空!"):(this.optionsArr.push({id:""+this.optionsArr.length,value:""+(new Date).getTime(),label:this.inputContent,sort:this.optionsArr.length+1,edit:!1}),this.inputContent="")},remove:function(t,e){"systemDefined"===this.flow.rank?this.$toast("默认选项无法删除!"):(this.newFlow.dicts=this.flow.dicts,this.optionsArr=this.optionsArr.filter(function(e){return e.label!==t.label}))},modifyOption:function(t,e){this.newFlow.dicts.find(function(e){return e.label===t.label})?(this.$toast("该选项已存在!"),t.label=this.optionInputTemp,this.optionInputTemp=""):""===t.label||/^[ ]$/.test(t.label)||(this.newFlow.dicts[e].label=this.optionsArr[e].label)},modifyDicName:function(){"systemDefined"!==this.flow.rank?/[\s]+/.test(this.dicName)?(this.submitCtrl=!0,this.errorMsg="请输入正确的字典名称",this.dicNameErrorTip=!0):(this.submitCtrl=!1,this.newFlow.name=this.dicName,this.dicNameErrorTip=!1,this.errorMsg=""):this.$toast("默认名称无法修改!")},addModal:function(){this.dicNameErrorTip=!1,this.modalType=this.translate.addNew,this.showAddModal=!0}}}),l={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"container-fluid",attrs:{id:"dictionary-page"}},[i("div",{staticClass:"row text-center"},[i("v-table",{attrs:{title:t.translate.tableTitle,url:t.url,pagesize:"10",order:!0,idField:"id",columns:t.columns,multiple:!1,search:!0}},[i("div",{staticClass:"btn-group pull-right",attrs:{slot:"btn-group",role:"group"},slot:"btn-group"},[i("button",{staticClass:"btn blue",attrs:{type:"button"},on:{click:t.addModal}},[t._v(t._s(t.translate.addNew))]),t._v(" "),i("button",{staticClass:"btn blue",attrs:{type:"button"},on:{click:t.quickAddRecord}},[t._v("批量新增")])])])],1),t._v(" "),i("v-modal",{attrs:{show:t.showAddModal,effect:"fade",width:"446"}},[i("div",{staticClass:"modal-header",attrs:{slot:"modal-header"},slot:"modal-header"},[i("h5",{staticClass:"modal-title"},[t._v(t._s(t.modalType))])]),t._v(" "),i("div",{staticClass:"modal-body",attrs:{slot:"modal-body"},slot:"modal-body"},[i("div",{staticClass:"form-group class-committee-group"},[i("label",{staticClass:"classCommittee-text"},[t._v(t._s(t.translate.dictionaryTypeName)+":")]),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.dicName,expression:"dicName"}],staticClass:"optionInput",attrs:{type:"text",placeholder:t.translate.dictionaryNameInputPlaceholder,readonly:"systemDefined"===t.flow.rank,maxlength:"15"},domProps:{value:t.dicName},on:{click:t.dicNameDisabled,change:t.modifyDicName,input:function(e){e.target.composing||(t.dicName=e.target.value)}}})]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.dicNameErrorTip,expression:"dicNameErrorTip"}],staticClass:"dicNameErrorTip"},[t._v(t._s(t.errorMsg))]),t._v(" "),i("div",{staticClass:"dictionaryCreateOption"},[i("span",{on:{click:t.addOption}},[t._v(t._s(t.translate.dictionaryCreateOption))])]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.showOptionInput,expression:"showOptionInput"}],staticClass:"form-group"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.inputContent,expression:"inputContent"}],staticClass:"form-control name-input",attrs:{id:"formName",type:"text",maxlength:"15",placeholder:t.translate.dictionaryOptionInputPlaceholder},domProps:{value:t.inputContent},on:{change:t.optionInput,input:function(e){e.target.composing||(t.inputContent=e.target.value)}}})]),t._v(" "),i("div",{staticClass:"modal-body-content"},t._l(t.optionsArr,function(e,s){return i("div",{directives:[{name:"dragging",rawName:"v-dragging",value:{item:e,list:t.optionsArr,group:" "},expression:"{ item: option, list: optionsArr, group: ' ' }"}],key:s},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.label,expression:"option.label"}],staticClass:"optionInput",attrs:{type:"text",autofocus:"",readonly:!e.edit,maxlength:"20"},domProps:{value:e.label},on:{click:function(i){return t.editable(e,s)},change:function(i){return t.modifyOption(e,s)},input:function(i){i.target.composing||t.$set(e,"label",i.target.value)}}}),t._v(" "),i("i",{staticClass:"maticon remove",domProps:{innerHTML:t._s(t.icons("cancel"))},on:{mousedown:function(i){return t.remove(e,s)}}},[t._v("cancel")]),t._v(" "),i("i",{staticClass:"maticon order",attrs:{title:"长按拖拽排序"},domProps:{innerHTML:t._s(t.icons("swap_vert"))}},[t._v("swap_vert")])])}),0)]),t._v(" "),i("div",{staticClass:"modal-footer",attrs:{slot:"modal-footer"},slot:"modal-footer"},[i("button",{staticClass:"btn cancel-btn clearBtnBorder",attrs:{type:"button"},on:{click:t.cancel}},[t._v(t._s(t.translate.cancel))]),t._v(" "),i("button",{staticClass:"btn submit-btn clearBtnBorder",attrs:{type:"button"},on:{click:t.submit}},[t._v(t._s(t.translate.submit))])])]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:"importPage"===t.curRoute,expression:"curRoute === 'importPage'"}],attrs:{id:"previewImportPage"}},[i("v-import",t._b({on:{backParentPage:function(e){t.curRoute="allStaff"}}},"v-import",t.importParams,!1))],1)],1)},staticRenderFns:[]};var d=i("VU/8")(r,l,!1,function(t){i("WwN5")},null,null);e.default=d.exports}});