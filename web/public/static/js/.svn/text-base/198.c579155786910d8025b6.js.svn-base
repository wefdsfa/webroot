webpackJsonp([198],{c0Ha:function(e,t){},mDuV:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});s("xd7I");var o=s("C331"),a={props:{account:{default:null}},data:function(){return{select:{options:{building:[],floors:[]},defaultValue:{buildingId:"",floorId:""}},roomDataSetting:{roomList:[],isSelectedBed:!1,selectUserInfo:{},selectBed:{userId:"",userName:"",campus:"",zoneId:"",buildingId:"",roomId:"",bedId:""}},chnNumChar:["零","一","二","三","四","五","六","七","八","九"],chnUnitChar:["","十"],curSelectedRoom:"",isSelectedRoom:!1}},computed:{},created:function(){var e=this;Object(o.e)({url:"/api/apartment/userChoose/applyStatus",type:"get",success:function(t){if(t.state){if("CAN_NOT_APPLY"===t.data.batchCheckUserApplyStatus||"HAD_APPLY"===t.data.batchCheckUserApplyStatus){e.isSelectedRoom=!0;var s=t.data.campus?t.data.campus+"校区":"";e.curSelectedRoom="您已成功选择"+s+t.data.zone+"园区"+t.data.building+"楼栋"+t.data.room+"房间"+t.data.bed+"床位"}}else e.$toast(t.message)}}),Object(o.e)({url:"/api/apartment/userChoose/buildings",type:"get",success:function(t){t.state?e.select.options.building=t.data||[]:e.$toast(t.message)}}),this.roomDataSetting.selectBed.userId=this.account.userId,this.roomDataSetting.selectBed.userName=this.account.userName},methods:{_buildingSelected:function(e){var t=this;this.select.defaultValue.buildingId=e.value,this.select.options.building.forEach(function(s){if(s.buildingId===e.value){t.roomDataSetting.selectBed.campus=s.campus,t.roomDataSetting.selectBed.zoneId=s.zoneId,t.select.options.floors.splice(0,t.select.options.floors.length);for(var o=0;o<s.floor;o++)t.select.options.floors.push({value:(o+1).toString(),label:t.sectionToChinese(o+1)+"楼"})}})},_floorsSelected:function(e){this.select.defaultValue.floorId=e.value,e.value&&this._getRoomData()},_getRoomData:function(){var e=this;Object(o.e)({url:"/api/apartment/userChoose/list/rooms/"+this.select.defaultValue.buildingId+"/"+this.select.defaultValue.floorId,type:"get",success:function(t){if(t.state){if(t.data){for(var s in t.data)for(var o in t.data[s].isShowInfo||e.$set(t.data[s],"isShowInfo",!1),t.data[s].beds)t.data[s].beds[o].isSelected||e.$set(t.data[s].beds[o],"isSelected",!1);e.roomDataSetting.roomList=t.data}}else e.$toast(t.message)}})},sumbitSelect:function(e){var t=this;this.roomDataSetting.isSelectedBed?confirm("确定要提交选房吗？提交后不可更改")&&Object(o.e)({url:"/api/apartment/userChoose/selfChoose/"+this.roomDataSetting.selectBed.userId,dataType:"json",type:"post",data:this.roomDataSetting.selectBed,success:function(e){e.state?(t.$toast("提交成功"),t.isSelectedRoom=!0):t.$toast(e.message)}}):this.$toast("请先选择房间")},_showInfoBox:function(e,t){e.isShowInfo=!0,t&&(this.roomDataSetting.selectUserInfo=t.user)},_hideInfoBox:function(e){e.isShowInfo=!1},_selectBed:function(e,t){this.roomDataSetting.isSelectedBed?this.$toast("你已经选过房了"):t.canSelect?(this.roomDataSetting.selectBed.buildingId=t.buildingId,this.roomDataSetting.selectBed.roomId=e,this.roomDataSetting.selectBed.bedId=t.bedId,t.isSelected=!0,this.roomDataSetting.isSelectedBed=!0):this.$toast("抱歉！该床位不能选")},_cancelSelected:function(e){this.roomDataSetting.selectBed.buildingId="",this.roomDataSetting.selectBed.roomId="",this.roomDataSetting.selectBed.bedId="",e.isSelected=!1,this.roomDataSetting.isSelectedBed=!1},sectionToChinese:function(e){for(var t="",s="",o=0,a=!0;e>0;){var i=e%10;0===i?a||(a=!0,s=this.chnNumChar[i]+s):(a=!1,t=this.chnNumChar[i],s=(t+=this.chnUnitChar[o])+s),o++,e=Math.floor(e/10)}return s}}},i={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"student-select-room"}},[e._m(0),e._v(" "),s("div",{staticClass:"operating-area"},[s("div",{staticClass:"pull-left"},[s("div",{staticClass:"form-group"},[s("label",{staticClass:"input-label form-label"},[e._v("可选范围")]),e._v(" "),s("v-select",{staticClass:"btn-block form-select-style building-select-style",attrs:{value:e.select.defaultValue.buildingId,options:e.select.options.building,optionsLabel:"name",optionsValue:"buildingId",disabled:e.isSelectedRoom,search:"",multiple:!1},on:{afterSelected:e._buildingSelected}})],1),e._v(" "),s("div",{staticClass:"form-group"},[s("label",{staticClass:"input-label form-label"},[e._v("楼层")]),e._v(" "),s("v-select",{staticClass:"btn-block form-select-style floors-select-style",attrs:{value:e.select.defaultValue.floorId,options:e.select.options.floors,optionsLabel:"label",optionsValue:"value",disabled:e.isSelectedRoom,search:"",multiple:!1},on:{afterSelected:e._floorsSelected}})],1)]),e._v(" "),e.isSelectedRoom?e._e():s("div",{staticClass:"pull-right"},[s("button",{staticClass:"btn cancel-btn sumbit-btn",attrs:{type:"button"},on:{click:e.sumbitSelect}},[e._v("提交")])])]),e._v(" "),e.isSelectedRoom?s("div",{staticClass:"select-room-content selected-room-tips"},[e._v(e._s(e.curSelectedRoom))]):s("div",{staticClass:"select-room-content"},[s("GeminiScrollbar",{attrs:{scrollX:!1}},[s("div",{staticClass:"tips"},[e._v("使用说明：点击空床可选择床位，选床后点击姓名右侧删除按钮可取消选择，最后请点击提交按钮，提交后才算选房成功。")]),e._v(" "),e.roomDataSetting.roomList.length>0?s("div",{staticClass:"room-list"},e._l(e.roomDataSetting.roomList,function(t,o){return s("div",{key:o,staticClass:"room-member-container"},[s("div",{staticClass:"room-card"},[s("div",{staticClass:"room-card-head"},[e._v(e._s(t.roomNo))]),e._v(" "),s("div",{staticClass:"room-card-body"},e._l(t.beds,function(o,a){return o.user?s("div",{key:a,staticClass:"user-name",on:{mouseover:function(s){return e._showInfoBox(t,o)},mouseout:function(s){return e._hideInfoBox(t)}}},[e._v(e._s(o.user.name))]):s("div",{staticClass:"select-bed",class:o.canSelect?"":"no-select"},[o.isSelected?s("div",[s("span",{staticClass:"name"},[e._v(e._s(e.roomDataSetting.selectBed.userName))]),e._v(" "),s("i",{staticClass:"maticon pull-right",domProps:{innerHTML:e._s(e.icons("clear"))},on:{click:function(t){return e._cancelSelected(o)}}},[e._v("clear")])]):s("div",{staticClass:"empty-bed",on:{click:function(s){return e._selectBed(t.roomId,o)}}},[e._v("空床")])])}),0)]),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.isShowInfo,expression:"roomCell.isShowInfo"}],staticClass:"member-info-box",on:{mouseover:function(s){return e._showInfoBox(t)},mouseout:function(s){return e._hideInfoBox(t)}}},[e.roomDataSetting.selectUserInfo.originPlace?s("div",{staticClass:"originPlace",attrs:{title:e.roomDataSetting.selectUserInfo.originPlace}},[e._v(e._s(e.roomDataSetting.selectUserInfo.originPlace))]):e._e(),e._v(" "),e.roomDataSetting.selectUserInfo.department?s("div",{attrs:{title:e.roomDataSetting.selectUserInfo.department}},[e._v(e._s(e.roomDataSetting.selectUserInfo.department))]):e._e(),e._v(" "),s("div",{attrs:{title:e.roomDataSetting.selectUserInfo.grade+"级"+e.roomDataSetting.selectUserInfo.collegeShortName+e.roomDataSetting.selectUserInfo.educationLevel}},[e._v(e._s(e.roomDataSetting.selectUserInfo.grade)+"级"+e._s(e.roomDataSetting.selectUserInfo.collegeShortName)+e._s(e.roomDataSetting.selectUserInfo.educationLevel))]),e._v(" "),e.roomDataSetting.selectUserInfo.timeTable?s("div",{attrs:{title:e.roomDataSetting.selectUserInfo.timeTable}},[e._v(e._s(e.roomDataSetting.selectUserInfo.timeTable))]):e._e(),e._v(" "),e.roomDataSetting.selectUserInfo.airConditioningTemperature?s("div",{attrs:{title:e.roomDataSetting.selectUserInfo.airConditioningTemperature+"℃"}},[e._v(e._s(e.roomDataSetting.selectUserInfo.airConditioningTemperature)+"℃")]):e._e()])])}),0):s("div",{staticClass:"text-center"},[e._v("暂无数据")])])],1)])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"select-room-head"},[t("label",{staticClass:"head-title"},[this._v("学生选房")])])}]};var l=s("C7Lr")(a,i,!1,function(e){s("c0Ha")},null,null);t.default=l.exports}});