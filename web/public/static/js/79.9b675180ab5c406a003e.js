webpackJsonp([79],{"3vxA":function(t,e){},izvj:function(t,e){},vdEC:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("C331"),o=s("5rGT"),i=(o.a,{data:function(){return{testObj:{a:1,b:2},showSign:!1,showImgDetailStatus:!1,deleteImgWidth:1,imgDetailSrc:"",myAddress:"",powerSettingUrl:"/table-data/archives/permissions/getRoleList",powerSetColumns:[],userUrl:"/table-data/archives/permissions/getRoleListByUser",userColumns:[],showDetailStatus:!1,imgList:[],timestamp:"?timestamp=",enrollUserNo:"",enrollAddList:[],lang:"zh-cn",checkRows:[],powerSelectList:[],isEdit:!0,showAddModalStatus:!1,showSetModalStatus:!1,showUserModalStatus:!1,userRecord:{},editMenuId:"",editMenuName:"",editAddressValues:"",userTableOptions:[],userStatus:!1,addParams:{name:"",remark:""}}},components:{newAddress:o.a},props:{selectItem:{default:{}},orgM:{default:!1}},created:function(){var t=localStorage.getItem("lang");Object(a.g)(t)&&(this.lang=t),this.initTable(),this.initUserTable(),this.getPowerList()},methods:{initTable:function(){var t=this;this.powerSetColumns=[{title:"组别名称",id:"roleName",className:"text-left",width:100,search:{type:"input",data:{placeholder:""}},hidden:!1,formatter:function(t){return t.name}},{title:"组别说明",id:"remark",className:"text-left",width:100,hidden:!1},{title:"用户",id:"user",className:"text-left",width:100,hidden:!1,formatter:function(t){var e="";return t.roleUsers&&(t.roleUsers.forEach(function(t,s){t.user&&(e+=t.user.name+"、")}),e=e.substring(0,e.length-1)),e}},{id:"opt",title:"操作",className:"text-center",width:"260px",hidden:!1,formatter:function(e){return[{tag:"a",text:"编辑",className:"opt-btn",callback:function(e,s){t.editPower(e)}},{tag:"a",text:"配置",className:"opt-btn",callback:function(e,s){t.setPower(e)}},{tag:"a",text:"用户",className:"opt-btn",callback:function(e,s){t.setUser(e)}},{tag:"a",text:"删除",className:"opt-btn",callback:function(e,s){t.deletePower(e)}}]}}]},submitSetUser:function(){var t=this,e="api/archives/permissions/"+this.userRecord.id+"/updateRoleMember",s={roleUsers:this.userTableOptions.map(function(e){return{roleId:t.userRecord.id,name:e.user.name,userId:e.user.userId,position:e.position}}),name:this.userRecord.name,remark:this.userRecord.remark};Object(a.d)(e,s,"put").then(function(e){e.state&&(t.$toast("操作成功!"),t.showUserModalStatus=!1,t.timestamp="?timestamp="+(new Date).getTime())})},setCharge:function(t,e){this.userTableOptions[t].position=e},afterSelected:function(t){var e=t.name,s=!1;this.userTableOptions.forEach(function(t){t.user.name===e&&(s=!0)}),s||this.userTableOptions.push({user:{name:e,userId:t.userId},position:"MEMBER"})},changeAddress:function(t){this.editAddressValues=t},getPowerList:function(){var t=this;Object(a.d)("api/archives/permissions/getMenuList").then(function(e){e.state&&(t.powerSelectList=e.data.map(function(t){return t.checked=!1,t}))})},changePanel:function(t){this.userStatus=t},initUserTable:function(){this.userColumns=[{title:"工号",id:"userNo",className:"text-left",width:100,search:{type:"input",data:{placeholder:""}},hidden:!1},{title:"姓名",id:"name",className:"text-left",width:100,search:{type:"input",data:{placeholder:""}},hidden:!1},{title:"组别",id:"roleName",className:"text-left",width:100,search:{type:"input",data:{placeholder:""}},hidden:!1,formatter:function(t){var e="";return t.dutiesWithRoleVO&&(t.dutiesWithRoleVO.forEach(function(t){e+=t.name+","}),e=e.substring(0,e.length-1)),e}},{title:"角色",id:"position",className:"text-left",width:100,search:{type:"input",data:{placeholder:""}},hidden:!1,formatter:function(t){var e="";return t.dutiesWithRoleVO&&(t.dutiesWithRoleVO.forEach(function(t){"MEMBER"==t.position?e+="成员,":e+="负责人,"}),e=e.substring(0,e.length-1)),e}}]},getMenuList:function(t){var e=this;this.powerSelectList=this.powerSelectList.map(function(t){return t.checked=!1,t});var s="api/archives/permissions/"+t+"/getMenuProvince";Object(a.d)(s).then(function(t){t.state&&(t.data.roleMenu.forEach(function(t){e.checkedPowerSelect(t.menuId)}),t.data.roleProvince?(e.myAddress=t.data.roleProvince.province?t.data.roleProvince.province:"",e.myAddress+=t.data.roleProvince.provinceSecond?","+t.data.roleProvince.provinceSecond:""):e.myAddress="")})},checkedPowerSelect:function(t){this.powerSelectList.forEach(function(e){e.id===t&&(e.checked=!0)})},editPower:function(t){t?(this.isEdit=!0,this.addParams={name:t.name,remark:t.remark,id:t.id}):this.isEdit=!1,this.showAddModalStatus=!0},submitAdd:function(){var t=this,e="api/archives/permissions/insertGroup",s="post";this.isEdit&&(e="api/archives/query/permissions/updateRole",s="put"),Object(a.d)(e,this.addParams,s).then(function(e){e.state&&(t.$toast("操作成功!"),t.showAddModalStatus=!1,t.timestamp="?timestamp="+(new Date).getTime())})},submitSet:function(){var t=this,e="api/archives/permissions/"+this.editMenuId+"/updateMenuProvince",s=this.powerSelectList.filter(function(t){return t.checked}).map(function(e){return{menuId:e.id,roleId:t.editMenuId}});this.roleProvince.province=this.editAddressValues.split(",")[0],this.roleProvince.provinceSecond=this.editAddressValues.split(",")[1]?this.editAddressValues.split(",")[1]:"";var o={roleMenu:s,roleProvince:this.roleProvince,name:this.editMenuName};Object(a.d)(e,o,"put").then(function(e){e.state&&e.state&&(t.$toast("操作成功!"),t.showSetModalStatus=!1,t.timestamp="?timestamp="+(new Date).getTime())})},setPower:function(t){this.showSetModalStatus=!0,this.editMenuId=t.id,this.editMenuName=t.name,this.roleProvince=t.roleProvince?t.roleProvince:{province:"",roleId:t.id,provinceSecond:""},this.getMenuList(t.id)},setUser:function(t){this.userTableOptions=t.roleUsers,this.userRecord=t,this.showUserModalStatus=!0},deletePower:function(t){}},computed:{translate:function(){return Object(a.g)(this.lang).enrollManage}}}),r={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"enroll"},[s("v-table",{directives:[{name:"show",rawName:"v-show",value:!t.userStatus,expression:"!userStatus"}],attrs:{url:t.powerSettingUrl+t.timestamp,pagesize:"10",idField:"id",columns:t.powerSetColumns,columnsControl:!0,order:!0,search:!1}},[s("div",{staticClass:"btn-group pull-right",attrs:{slot:"btn-group",role:"group"},slot:"btn-group"},[s("button",{staticClass:"btn batch-add-btn btn-bgColor-style clearBtnBorder",attrs:{type:"button"},on:{click:function(e){return t.editPower()}}},[t._v("新增组别")]),t._v(" "),s("button",{staticClass:"btn batch-add-btn btn-bgColor-style clearBtnBorder",attrs:{type:"button"},on:{click:function(e){return t.changePanel(!0)}}},[t._v("切换到用户维度")])])]),t._v(" "),s("v-table",{directives:[{name:"show",rawName:"v-show",value:t.userStatus,expression:"userStatus"}],attrs:{url:t.userUrl+t.timestamp,pagesize:"10",idField:"id",columns:t.userColumns,columnsControl:!0,order:!0,search:!1}},[s("div",{staticClass:"btn-group pull-right",attrs:{slot:"btn-group",role:"group"},slot:"btn-group"},[s("button",{staticClass:"btn batch-add-btn btn-bgColor-style clearBtnBorder",attrs:{type:"button"},on:{click:function(e){return t.changePanel(!1)}}},[t._v("切换到组别")])])]),t._v(" "),s("v-modal",{attrs:{show:t.showAddModalStatus,effect:"fade",width:"400"}},[s("div",{staticClass:"modal-header",attrs:{slot:"modal-header"},slot:"modal-header"},[s("h5",{staticClass:"modal-title"},[t._v("新增组别")])]),t._v(" "),s("div",{staticClass:"modal-body setParty form-wrap",staticStyle:{overflow:"inherit"},attrs:{slot:"modal-body"},slot:"modal-body"},[s("div",{staticClass:"form-group box_flex align_center"},[s("label",{staticClass:"partyName label",staticStyle:{"margin-right":"5px"}},[t._v("组别名称")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.addParams.name,expression:"addParams['name']"}],staticClass:"form-control search-input organization-input",attrs:{type:"text"},domProps:{value:t.addParams.name},on:{input:function(e){e.target.composing||t.$set(t.addParams,"name",e.target.value)}}})]),t._v(" "),s("div",{staticClass:"form-group box_flex "},[s("label",{staticClass:"partyName label",staticStyle:{"margin-right":"5px"}},[t._v("组别说明")]),t._v(" "),s("v-textarea",{staticClass:"info_value",staticStyle:{overflow:"hidden",height:"60px",width:"200px"},attrs:{autoHeight:!0,rows:"3",maxLength:200},model:{value:t.addParams.remark,callback:function(e){t.$set(t.addParams,"remark",e)},expression:"addParams['remark']"}})],1)]),t._v(" "),s("div",{staticClass:"modal-footer",attrs:{slot:"modal-footer"},slot:"modal-footer"},[s("button",{staticClass:"btn cancel-btn clearBtnBorder",attrs:{type:"button"},on:{click:function(e){t.showAddModalStatus=!1}}},[t._v("取消")]),t._v(" "),s("button",{staticClass:"btn submit-btn clearBtnBorder",attrs:{type:"button"},on:{click:function(e){return t.submitAdd()}}},[t._v("确定")])])]),t._v(" "),s("v-modal",{attrs:{show:t.showSetModalStatus,effect:"fade",width:"520"}},[s("div",{staticClass:"modal-header",attrs:{slot:"modal-header"},slot:"modal-header"},[s("h5",{staticClass:"modal-title"},[t._v("配置")])]),t._v(" "),s("div",{staticClass:"modal-body setParty form-wrap",staticStyle:{overflow:"inherit"},attrs:{slot:"modal-body"},slot:"modal-body"},[s("h5",{staticClass:"modal-title"},[t._v("权限配置")]),t._v(" "),s("div",{staticClass:"box_flex flex_wrap"},t._l(t.powerSelectList,function(e,a){return s("div",{key:a,staticClass:"power_child"},[s("checkbox",{attrs:{name:e.name},model:{value:e.checked,callback:function(s){t.$set(e,"checked",s)},expression:"item.checked"}})],1)}),0),t._v(" "),s("h5",{staticClass:"modal-title",staticStyle:{"border-top":"1px solid #ddd",width:"100%",padding:"10px 0"}},[t._v("权限配置")]),t._v(" "),s("div",{staticClass:"form-group box_flex align_center"},[s("label",{staticClass:"partyName label",staticStyle:{"margin-right":"5px",width:"auto"}},[t._v("生源地")]),t._v(" "),s("newAddress",{attrs:{value:t.myAddress,width:180,noArea:"true"},on:{onChange:t.changeAddress}})],1)]),t._v(" "),s("div",{staticClass:"modal-footer",attrs:{slot:"modal-footer"},slot:"modal-footer"},[s("button",{staticClass:"btn cancel-btn clearBtnBorder",attrs:{type:"button"},on:{click:function(e){t.showSetModalStatus=!1}}},[t._v("取消")]),t._v(" "),s("button",{staticClass:"btn submit-btn clearBtnBorder",attrs:{type:"button"},on:{click:function(e){return t.submitSet()}}},[t._v("确定")])])]),t._v(" "),s("v-modal",{attrs:{show:t.showUserModalStatus,effect:"fade",width:"520"}},[s("div",{staticClass:"modal-header",attrs:{slot:"modal-header"},slot:"modal-header"},[s("h5",{staticClass:"modal-title"},[t._v("配置")])]),t._v(" "),s("div",{staticClass:"modal-body setParty form-wrap user-modal-body",staticStyle:{overflow:"inherit"},attrs:{slot:"modal-body"},slot:"modal-body"},[s("v-table",{attrs:{rows:t.userTableOptions,paginationShow:!1,idField:"id",columns:t.userColumns}}),t._v(" "),s("div",{staticClass:"form-group box_flex align_center",staticStyle:{"margin-top":"20px"}},[s("label",{staticClass:"partyName label",staticStyle:{"margin-right":"5px",width:"auto"}},[t._v("用户检索")]),t._v(" "),s("detect",{attrs:{url:"api/archives/check/searchResults"},on:{afterSelected:t.afterSelected}})],1)],1),t._v(" "),s("div",{staticClass:"modal-footer",attrs:{slot:"modal-footer"},slot:"modal-footer"},[s("button",{staticClass:"btn cancel-btn clearBtnBorder",attrs:{type:"button"},on:{click:function(e){t.showUserModalStatus=!1}}},[t._v("取消")]),t._v(" "),s("button",{staticClass:"btn submit-btn clearBtnBorder",attrs:{type:"button"},on:{click:function(e){return t.submitSetUser()}}},[t._v("确定")])])])],1)},staticRenderFns:[]};var n=s("VU/8")(i,r,!1,function(t){s("3vxA"),s("izvj")},"data-v-8a6efb90",null);e.default=n.exports}});